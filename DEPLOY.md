# Інструкція з розгортання та автоматизації

Цей документ пояснює, як налаштувати автоматичний запуск пайплайну для генерації сигналів на Windows Server.

## Архітектура

Система розділена на два основні компоненти:

1.  **`scheduler.py`**: Консольний скрипт, який послідовно виконує всі етапи пайплайну (збір даних, підготовка, тренування, генерація сигналів). Цей скрипт призначений для автоматичного запуску за розкладом.
2.  **`scripts/web_server.py`**: Веб-сервер, який надає лише одне завдання — відображення останніх згенерованих сигналів з файлу `outputs/signals.json`. Він не виконує жодних обчислень.

## Крок 1: Налаштування середовища

1.  Переконайтеся, що на вашому Windows Server встановлено Python 3.10+.
2.  Склонуйте цей репозиторій.
3.  Створіть та активуйте віртуальне середовище:
    ```bash
    python -m venv .venv
    .venv\Scripts\activate
    ```
4.  Встановіть необхідні залежності:
    ```bash
    pip install -r requirements.txt
    ```
5.  **Важливо:** Встановіть та запустіть термінал MetaTrader 5. Увійдіть у свій торговий рахунок. Скрипти не зможуть отримувати дані, якщо термінал не запущено.

## Крок 2: Налаштування автоматичного запуску пайплайну

Ми будемо використовувати стандартний `Task Scheduler` (Планувальник завдань) у Windows.

1.  **Відкрийте Task Scheduler:**
    *   Натисніть `Win + R`, введіть `taskschd.msc` та натисніть Enter.

2.  **Створіть нове завдання:**
    *   У правій панелі `Actions` виберіть `Create Basic Task...`.
    *   **Name:** Введіть ім'я для завдання, наприклад, `Forex Signals Pipeline`.
    *   **Description:** Додайте опис, наприклад, `Runs the full data processing and model training pipeline`.
    *   Натисніть `Next`.

3.  **Налаштуйте тригер ( розклад):**
    *   Виберіть, як часто ви хочете запускати пайплайн. Наприклад, `Daily` (Щодня) або `Weekly` (Щотижня).
    *   Налаштуйте точний час запуску. Рекомендується вибирати час низького навантаження на сервер (наприклад, ніч).
    *   Натисніть `Next`.

4.  **Налаштуйте дію (Action):**
    *   Виберіть `Start a program`.
    *   **Program/script:** Вкажіть **абсолютний шлях** до інтерпретатора Python у вашому віртуальному середовищі. Наприклад:
        ```
        D:\LLM\LSTMC\.venv\Scripts\python.exe
        ```
    *   **Add arguments (optional):** Вкажіть **абсолютний шлях** до скрипта `scheduler.py`. Наприклад:
        ```
        D:\LLM\LSTMC\scheduler.py
        ```
    *   **Start in (optional):** Вкажіть **абсолютний шлях** до кореневої директорії проекту. Це **дуже важливо**, оскільки скрипт використовує відносні шляхи до конфігурації та інших файлів.
        ```
        D:\LLM\LSTMC\
        ```
    *   Натисніть `Next`.

5.  **Завершення:**
    *   Перегляньте налаштування та натисніть `Finish`.

Тепер планувальник буде автоматично запускати ваш пайплайн у вказаний час.

## Крок 3: Запуск веб-сервера

Веб-сервер потрібно запустити як постійну службу, щоб він працював у фоновому режимі.

1.  Відкрийте командний рядок в директорії проекту та активуйте віртуальне середовище.
2.  Запустіть сервер командою:
    ```bash
    codex run web
    ```
3.  Для надійної роботи на сервері рекомендується використовувати інструмент типу `nssm` (Non-Sucking Service Manager), щоб перетворити запуск `uvicorn` на справжню службу Windows, яка буде автоматично перезапускатися.

Після цього ви зможете відкрити адресу вашого сервера (наприклад, `http://your_server_ip:8000`) у браузері та бачити останні згенеровані сигнали.
